{
    "collab_server" : "",
    "contents" : "\n# Import package ----------------------------------------------------------\nlibrary(isa2)\nlibrary(gplots)\nlibrary(ggplot2)\n\n\n# ISA functions -----------------------------------------------------------\nsource('C:/Mimi/Stage_CBG/2.EXPRESSION_MODULE/expression_module/ISA_functions.R')\n\n\n# Grafical parameters -----------------------------------------------------\n## green, yellow and red scale used for heatmap plot (used in the case of a graphical representation of the percentage of identity for example)\nmy_palette <- colorRampPalette(c(\"red\", \"yellow\", \"green\"))(n = 299)\ncol_breaks = c(seq(0,0.33,length=100),             # for red\n               seq(0.34,0.66,length=100),          # for yellow\n               seq(0.67,1,length=100))             # for green\n\n\n# Import Data -------------------------------------------------------------\n\n## serum data\nserum <- read.csv(\"C://Mimi/Stage_CBG/2.EXPRESSION_MODULE/Data/metabolomics/serum.nmr.focus.all.colaus1.20160830.csv\", h = F)\nppm <- paste(\"ppm\", serum[1,2:ncol(serum)], sep =\"_\")\ntp  <- paste(\"id\", serum[2:nrow(serum),1], sep = \"_\")\nserum <- serum[2:nrow(serum), 2:ncol(serum)]\ncolnames(serum) <- ppm\nrownames(serum) <- tp\n\n## urine data\nurine <- read.csv(\"C://Mimi/Stage_CBG/2.EXPRESSION_MODULE/Data/metabolomics/urine.nmr.focus.all.colaus1.20161205.csv\", h = F)\nppm <- paste(\"ppm\", urine[1,2:ncol(urine)], sep =\"_\")\ntp  <- paste(\"id\", urine[2:nrow(urine),1], sep = \"_\")\nurine <- urine[2:nrow(urine), 2:ncol(urine)]\ncolnames(urine) <- ppm\nrownames(urine) <- tp\n\nrm(\"ppm\", \"tp\")\n## select matching id (790 individuals having serum and urine metabolomics)\nserum <- serum[rownames(serum) %in% rownames(uri